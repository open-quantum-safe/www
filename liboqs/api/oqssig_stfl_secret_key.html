---
layout: default
parent: C API documentation
grand_parent: liboqs
title: OQS_SIG_STFL_SECRET_KEY struct
---

<h1><span class="text-muted">struct</span> <b>OQS_SIG_STFL_SECRET_KEY</b></h1>

<div class="lead">
  
<p>OQS_SIG_STFL_SECRET_KEY object for stateful signature schemes. </p>
    
</div>

    


  <br><br>
  <h2>Includes</h2>
  <hr>
  
  <code>
    <span class="text-muted">#include <</span><b>sig_stfl.h</b><span class="text-muted">></span>
  </code>
  



  <br><br>
  <h2>Members</h2>
  <table class="table">
  
    <tr>
      <td class="text-right"><code><span class="text-muted">size_t</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a420a4b0415d391e3b24bc522ff41d67b">length_secret_key</a></b><span class="text-muted"></span></code></td>
    </tr>
  
    <tr>
      <td class="text-right"><code><span class="text-muted">void *</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a6a3ed17983adad27237ccf6e80959831">secret_key_data</a></b><span class="text-muted"></span></code></td>
    </tr>
  
    <tr>
      <td class="text-right"><code><span class="text-muted">void *</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a69c415ad44bb6ac714f7938331ba4ccb">mutex</a></b><span class="text-muted"></span></code></td>
    </tr>
  
    <tr>
      <td class="text-right"><code><span class="text-muted">void *</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1ab565887329aaee3216ba0b747d16e946">context</a></b><span class="text-muted"></span></code></td>
    </tr>
  
    <tr>
      <td class="text-right"><code><span class="text-muted">OQS_STATUS(*</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a8f1a1597686088170aac748f9672d440">serialize_key</a></b><span class="text-muted">)(uint8_t **sk_buf_ptr, size_t *sk_buf_len, const OQS_SIG_STFL_SECRET_KEY *sk)</span></code></td>
    </tr>
  
    <tr>
      <td class="text-right"><code><span class="text-muted">OQS_STATUS(*</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a4868dc05acd46dfa4d4fcde013333e7b">deserialize_key</a></b><span class="text-muted">)(OQS_SIG_STFL_SECRET_KEY *sk, const uint8_t *sk_buf, const size_t sk_buf_len, void *context)</span></code></td>
    </tr>
  
    <tr>
      <td class="text-right"><code><span class="text-muted">OQS_STATUS(*</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a23a70cdebb591e8a4204e7c171a75037">lock_key</a></b><span class="text-muted">)(void *mutex)</span></code></td>
    </tr>
  
    <tr>
      <td class="text-right"><code><span class="text-muted">OQS_STATUS(*</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a22c4581a0a281a12388e5e42bddeb49d">unlock_key</a></b><span class="text-muted">)(void *mutex)</span></code></td>
    </tr>
  
    <tr>
      <td class="text-right"><code><span class="text-muted">OQS_STATUS(*</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1ab7fe4b4bfc2d7c4385bf6f5030293c9f">secure_store_scrt_key</a></b><span class="text-muted">)(uint8_t *sk_buf, size_t sk_buf_len, void *context)</span></code></td>
    </tr>
  
    <tr>
      <td class="text-right"><code><span class="text-muted">void(*</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1aa810d88f323e9cc0c4d019059153323d">free_key</a></b><span class="text-muted">)(OQS_SIG_STFL_SECRET_KEY *sk)</span></code></td>
    </tr>
  
    <tr>
      <td class="text-right"><code><span class="text-muted">void(*</span></code></td>
      <td><code><b><a href="#struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a8c1f6b0374fbf693496548c74fca0cb1">set_scrt_key_store_cb</a></b><span class="text-muted">)(OQS_SIG_STFL_SECRET_KEY *sk, secure_store_sk store_cb, void *context)</span></code></td>
    </tr>
  
</table>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L380" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a420a4b0415d391e3b24bc522ff41d67b">length_secret_key</h3>
    <div class="card-subtitle mb-2"><code>size_t <b>length_secret_key</b></code></div>
    <div class="card-text">
      
<p>The (maximum) length, in bytes, of secret keys for this signature scheme. </p>
        
    </div>
    
    
  </div>
</div>
    <br>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L383" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a6a3ed17983adad27237ccf6e80959831">secret_key_data</h3>
    <div class="card-subtitle mb-2"><code>void * <b>secret_key_data</b></code></div>
    <div class="card-text">
      
<p>The variant-specific secret key data must be allocated at the initialization. </p>
        
    </div>
    
    
  </div>
</div>
    <br>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L386" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a69c415ad44bb6ac714f7938331ba4ccb">mutex</h3>
    <div class="card-subtitle mb-2"><code>void * <b>mutex</b></code></div>
    <div class="card-text">
      
<p>The mutual exclusion struct </p>
        
    </div>
    
    
  </div>
</div>
    <br>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L389" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1ab565887329aaee3216ba0b747d16e946">context</h3>
    <div class="card-subtitle mb-2"><code>void * <b>context</b></code></div>
    <div class="card-text">
      
<p>Application-managed data related to secure storage of secret key data </p>
        
    </div>
    
    
  </div>
</div>
    <br>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L406" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a8f1a1597686088170aac748f9672d440">serialize_key</h3>
    <div class="card-subtitle mb-2"><code>OQS_STATUS(* <b>serialize_key</b>)(uint8_t **sk_buf_ptr, size_t *sk_buf_len, const OQS_SIG_STFL_SECRET_KEY *sk)</code></div>
    <div class="card-text">
      
<p>Serialize the stateful secret key.</p>
<p>This function encodes the stateful secret key represented by <code>sk</code> into a byte stream for storage or transfer. The <code>sk_buf_ptr</code> will point to the allocated memory containing the byte stream. Users must free the <code>sk_buf_ptr</code> using <code>OQS_MEM_secure_free</code> after use. The <code>sk_len</code> will contain the length of the byte stream.</p>
<p>


</p>
        
    </div>
    
      <h4>Parameters</h4>
      <table class="table mb-0">
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>sk_buf_ptr</code></td>
            <td class="pb-0">
<p>Pointer to the byte stream representing the serialized secret key. </p>
</td>
          </tr>
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>sk_buf_len</code></td>
            <td class="pb-0">
<p>Pointer to the length of the serialized byte stream. </p>
</td>
          </tr>
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>sk</code></td>
            <td class="pb-0">
<p>Pointer to the <code>None</code> object to serialize. </p>
</td>
          </tr>
        
      </table>
    
    
      <h4>Returns</h4>
      <div class="ml-5"><p>The number of bytes in the serialized byte stream upon success, or an OQS error code on failure.</p>
</div>
    
  </div>
</div>
    <br>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L423" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a4868dc05acd46dfa4d4fcde013333e7b">deserialize_key</h3>
    <div class="card-subtitle mb-2"><code>OQS_STATUS(* <b>deserialize_key</b>)(OQS_SIG_STFL_SECRET_KEY *sk, const uint8_t *sk_buf, const size_t sk_buf_len, void *context)</code></div>
    <div class="card-text">
      
<p>Deserialize a byte stream into the internal representation of a stateful secret key.</p>
<p>This function takes a series of bytes representing a stateful secret key and initializes the internal <code>None</code> object with the key material. This is particularly useful for reconstructing key objects from persisted or transmitted state.</p>
<p>


</p>
        
    </div>
    
      <h4>Parameters</h4>
      <table class="table mb-0">
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>sk</code></td>
            <td class="pb-0">
<p>Pointer to an uninitialized <code>None</code> object to hold the secret key. </p>
</td>
          </tr>
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>sk_buf</code></td>
            <td class="pb-0">
<p>Pointer to the byte stream containing the serialized secret key data. </p>
</td>
          </tr>
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>sk_buf_len</code></td>
            <td class="pb-0">
<p>The length of the secret key byte stream. </p>
</td>
          </tr>
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>context</code></td>
            <td class="pb-0">
<p>Pointer to application-specific data, handled externally, associated with the key. </p>
</td>
          </tr>
        
      </table>
    
    
      <h4>Returns</h4>
      <div class="ml-5"><p>OQS_SUCCESS if the deserialization succeeds, with the <code>sk</code> object populated with the key material.</p>
</div>
    
  </div>
</div>
    <br>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L431" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a23a70cdebb591e8a4204e7c171a75037">lock_key</h3>
    <div class="card-subtitle mb-2"><code>OQS_STATUS(* <b>lock_key</b>)(void *mutex)</code></div>
    <div class="card-text">
      
<p>Secret Key Locking Function</p>
<p>

</p>
        
    </div>
    
      <h4>Parameters</h4>
      <table class="table mb-0">
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>mutex</code></td>
            <td class="pb-0">
<p>application defined mutex </p>
</td>
          </tr>
        
      </table>
    
    
      <h4>Returns</h4>
      <div class="ml-5"><p>OQS_SUCCESS or OQS_ERROR </p>
</div>
    
  </div>
</div>
    <br>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L439" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a22c4581a0a281a12388e5e42bddeb49d">unlock_key</h3>
    <div class="card-subtitle mb-2"><code>OQS_STATUS(* <b>unlock_key</b>)(void *mutex)</code></div>
    <div class="card-text">
      
<p>Secret Key Unlocking / Releasing Function</p>
<p>

</p>
        
    </div>
    
      <h4>Parameters</h4>
      <table class="table mb-0">
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>mutex</code></td>
            <td class="pb-0">
<p>application defined mutex </p>
</td>
          </tr>
        
      </table>
    
    
      <h4>Returns</h4>
      <div class="ml-5"><p>OQS_SUCCESS or OQS_ERROR </p>
</div>
    
  </div>
</div>
    <br>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L454" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1ab7fe4b4bfc2d7c4385bf6f5030293c9f">secure_store_scrt_key</h3>
    <div class="card-subtitle mb-2"><code>OQS_STATUS(* <b>secure_store_scrt_key</b>)(uint8_t *sk_buf, size_t sk_buf_len, void *context)</code></div>
    <div class="card-text">
      
<p>Store Secret Key Function</p>
<p>Callback function used to securely store key data after a signature generation. When populated, this pointer points to the application-supplied secure storage function. 

</p>
        
    </div>
    
      <h4>Parameters</h4>
      <table class="table mb-0">
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>sk_buf</code></td>
            <td class="pb-0">
<p>The serialized secret key data to secure store </p>
</td>
          </tr>
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>sk_buf_len</code></td>
            <td class="pb-0">
<p>length of data to secure </p>
</td>
          </tr>
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>context</code></td>
            <td class="pb-0">
<p>application supplied data used to locate where this secret key is stored (passed in at the time the function pointer was set).</p>
</td>
          </tr>
        
      </table>
    
    
      <h4>Returns</h4>
      <div class="ml-5"><p>OQS_SUCCESS or OQS_ERROR Ideally written to a secure device. </p>
</div>
    
  </div>
</div>
    <br>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L462" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1aa810d88f323e9cc0c4d019059153323d">free_key</h3>
    <div class="card-subtitle mb-2"><code>void(* <b>free_key</b>)(OQS_SIG_STFL_SECRET_KEY *sk)</code></div>
    <div class="card-text">
      
<p>Free internal variant-specific data</p>
<p>

</p>
        
    </div>
    
      <h4>Parameters</h4>
      <table class="table mb-0">
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>sk</code></td>
            <td class="pb-0">
<p>The secret key represented as OQS_SIG_STFL_SECRET_KEY object. </p>
</td>
          </tr>
        
      </table>
    
    
      <h4>Returns</h4>
      <div class="ml-5"><p>None. </p>
</div>
    
  </div>
</div>
    <br>
    <div class="card">
  <div class="card-body">
    <div class="float-right"><small><a href="https://github.com/open-quantum-safe/liboqs/tree/main/src/sig_stfl/sig_stfl.h#L486" target="_blank">[src]</a></small></div>
    <h3 class="card-title" id="struct_o_q_s___s_i_g___s_t_f_l___s_e_c_r_e_t___k_e_y_1a8c1f6b0374fbf693496548c74fca0cb1">set_scrt_key_store_cb</h3>
    <div class="card-subtitle mb-2"><code>void(* <b>set_scrt_key_store_cb</b>)(OQS_SIG_STFL_SECRET_KEY *sk, secure_store_sk store_cb, void *context)</code></div>
    <div class="card-text">
      
<p>Set Secret Key Store Callback Function</p>
<p>This function is used to establish a callback mechanism for secure storage of private keys involved in stateful signature Signing operation. The secure storage and the management of private keys is the responsibility of the adopting application. Therefore, before invoking stateful signature generation, a callback function and associated context data must be provided by the application to manage the storage.</p>
<p>The <code>context</code> argument is designed to hold information requisite for private key storage, such as a hardware security module (HSM) context, a file path, or other relevant data. This context is passed to the libOQS when the callback function is registered.</p>
<p>

</p>
        
    </div>
    
      <h4>Parameters</h4>
      <table class="table mb-0">
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>sk</code></td>
            <td class="pb-0">
<p>A pointer to the secret key object that requires secure storage management after signature Signing operations. </p>
</td>
          </tr>
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>store_cb</code></td>
            <td class="pb-0">
<p>A pointer to the callback function provided by the application for storing and updating the private key securely. </p>
</td>
          </tr>
        
          <tr>
            <td class="text-right"><code class="text-muted"></code></td>
            <td><code>context</code></td>
            <td class="pb-0">
<p>Application-specific context information for the private key storage, furnished when setting the callback function via OQS_SIG_STFL_SECRET_KEY_set_store_cb(). </p>
</td>
          </tr>
        
      </table>
    
    
      <h4>Returns</h4>
      <div class="ml-5"><p>None. </p>
</div>
    
  </div>
</div>
    <br>



      <br><br>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

  </body>

</html>
